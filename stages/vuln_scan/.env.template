# Vulnerability Scanning Stage Environment Configuration
# Copy this file to .env and update with your specific values

# Backend API Configuration
BACKEND_API_URL=http://backend:8000/api/results/vuln-scan
BACKEND_JWT_TOKEN=your_jwt_token_here

# JWT Configuration (must match backend)
JWT_SECRET=your_jwt_secret_here
JWT_ALGORITHM=HS256

# Stage Configuration
STAGE_NAME=vuln_scan
TARGET=example.com
STAGE_TIMEOUT_SECONDS=1800

# Output Configuration
OUTPUT_DIR=/app/outputs
SCAN_DIR=/app/scans
LOG_DIR=/app/logs

# Scanning Configuration
SCAN_TYPES=nuclei,nmap,nikto,zap,wapiti,arachni
NUCLEI_TEMPLATES=all
NMAP_SCAN_TYPES=syn,connect,udp
ZAP_SCAN_MODE=api
WAPITI_MODULES=blindsql,exec,file,perlxss,shellshock,sql,xss

# Tool Configuration
NUCLEI_PATH=/root/go/bin/nuclei
NMAP_PATH=/usr/bin/nmap
NIKTO_PATH=/usr/bin/nikto
ZAP_PATH=/opt/zap/zap.sh
WAPITI_PATH=/usr/bin/wapiti
ARACHNI_PATH=/usr/bin/arachni
HTTPX_PATH=/root/go/bin/httpx
SUBFINDER_PATH=/root/go/bin/subfinder
AMASS_PATH=/root/go/bin/amass

# Scanning Limits
MAX_CONCURRENT_SCANS=5
RATE_LIMIT=10
TIMEOUT_PER_SCAN=300

# Font Configuration (minimal fonts for smaller image size)
FONT_PACKAGES=fonts-liberation,fonts-dejavu-core,fonts-dejavu-extra

# Resource Limits
MAX_MEMORY_MB=2048
MAX_CPU_CORES=0.8

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE=vuln_scan.log

# Health Check Configuration
HEALTH_CHECK_URL=http://localhost:8000/health/
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3 