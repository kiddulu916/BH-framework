# Vulnerability Testing Stage Environment Configuration
# Copy this file to .env and update with your specific values

# Backend API Configuration
BACKEND_API_URL=http://backend:8000/api/results/vuln-test
BACKEND_JWT_TOKEN=your_jwt_token_here

# JWT Configuration (must match backend)
JWT_SECRET=your_jwt_secret_here
JWT_ALGORITHM=HS256

# Stage Configuration
STAGE_NAME=vuln_test
TARGET=example.com
STAGE_TIMEOUT_SECONDS=2400

# Output Configuration
OUTPUT_DIR=/app/outputs
EVIDENCE_DIR=/app/evidence
MODELS_DIR=/app/models
LOG_DIR=/app/logs

# AI/ML Configuration
AI_MODEL_PATH=/app/models/vulnerability_analyzer
AI_CONFIDENCE_THRESHOLD=0.8
ENABLE_AI_ANALYSIS=true
MODEL_TYPE=transformer
BATCH_SIZE=32

# Browser Automation Configuration
ENABLE_BROWSER_SCANNING=true
BROWSER_TYPE=playwright
HEADLESS=true
SCREENSHOT_EVIDENCE=true
VIDEO_RECORDING=false
BROWSER_TIMEOUT=30000

# API Scanning Configuration
ENABLE_API_SCANNING=true
API_FUZZING_ENABLED=true
OPENAPI_IMPORT_ENABLED=true
GRAPHQL_SCANNING_ENABLED=true
REST_API_SCANNING_ENABLED=true

# Network Scanning Configuration
ENABLE_NETWORK_SCANNING=true
PORT_SCANNING_ENABLED=true
SERVICE_DETECTION_ENABLED=true
VULNERABILITY_SCANNING_ENABLED=true

# Exploit Testing Configuration
ENABLE_EXPLOIT_TESTING=true
SAFE_EXPLOIT_MODE=true
MAX_EXPLOIT_ATTEMPTS=3
EXPLOIT_TIMEOUT=60
RATE_LIMIT=10

# Evidence Collection Configuration
ENABLE_EVIDENCE_COLLECTION=true
SCREENSHOT_QUALITY=high
VIDEO_RECORDING=false
EVIDENCE_COMPRESSION=true

# Tool Configuration
NMAP_PATH=/usr/bin/nmap
NIKTO_PATH=/usr/bin/nikto
SQLMAP_PATH=/usr/bin/sqlmap
HYDRA_PATH=/usr/bin/hydra
DIRB_PATH=/usr/bin/dirb
GOBUSTER_PATH=/usr/bin/gobuster
FFUF_PATH=/usr/bin/ffuf
WFUZZ_PATH=/usr/bin/wfuzz
WHATWEB_PATH=/usr/bin/whatweb
WAFW00F_PATH=/usr/bin/wafw00f
HTTPX_PATH=/root/go/bin/httpx
NUCLEI_PATH=/root/go/bin/nuclei
SUBFINDER_PATH=/root/go/bin/subfinder
AMASS_PATH=/root/go/bin/amass
NAABU_PATH=/root/go/bin/naabu
KATANA_PATH=/root/go/bin/katana
FEROXBUSTER_PATH=/usr/bin/feroxbuster
FINGERPRINTX_PATH=/root/go/bin/fingerprintx

# Browser Configuration
CHROME_BIN=/usr/bin/chromium
CHROMEDRIVER_PATH=/usr/bin/chromedriver
FIREFOX_BIN=/usr/bin/firefox-esr
GECKODRIVER_PATH=/usr/bin/geckodriver

# Safety and Ethical Controls
RATE_LIMIT=10
MAX_CONCURRENT_TESTS=5
SCOPE_BOUNDARIES=
SAFE_MODE=true
ETHICAL_HACKING_MODE=true

# Font Configuration (minimal fonts for smaller image size)
FONT_PACKAGES=fonts-liberation,fonts-dejavu-core,fonts-dejavu-extra

# Resource Limits
MAX_MEMORY_MB=4096
MAX_CPU_CORES=1.0

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE=vuln_test.log

# Health Check Configuration
HEALTH_CHECK_URL=http://localhost:8000/health/
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3 